<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Algorithmic Regularization Chain (ARC): ARC Introduction</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Algorithmic Regularization Chain (ARC)
   </div>
   <div id="projectbrief">Algorithmic Regularization Chain for few body motions</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title"><a class="el" href="namespaceARC.html" title="Algorithmic regularization chain (ARC) namespace. ">ARC</a> Introduction </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="AR_sec"></a>
Algorithmic Regularization (AR)</h1>
<p>The algorithm used in this code is based on the literatures of <a href="http://adsabs.harvard.edu/abs/1999MNRAS.310..745M">Mikkola &amp; Tanikawa (1999)</a> and <a href="http://adsabs.harvard.edu/abs/1999AJ....118.2532P">Preto &amp; Tremaine (1999)</a>. The development of this code refers to the Chapter 2 (Mikkola) in book <a href="http://www.springer.com/us/book/9781402084300">The Cambridge N-body Lectures</a>. Here the basic idea of AR is described.</p>
<p>The numerical simulations of gravitational N-body systems dynamical evolutions are frequently used in astrophysics. However, due to the singularity of two-body gravitational potential when these two particles become infinite close lead to the difficulty in the highly accurately integration of two-body bounded system with very high eccentricity. To get high accuracy of integration when two particles are very close, the time step for integration should be reduced significantly. This result in time consuming computation if number of particles is large. On the other hand, for a long-term integration, the total energy of the systems may be systematiclly drifted due to the numerical accuracy of integrators. Thus the sympletic methods are suggested to be used since it can keep the energy conservation for long-term integration.</p>
<p>However, the sympletic methods are difficult to be applied for gravitational systems due to the required time step (integration step) shrinking when two particle get close. Thus Mikkola &amp; Tanikawa (1999) and Preto &amp; Tremaine (1999) develop the special time transformation method based on the extended phase space Hamiltonian. The time <img class="formulaInl" alt="$t$" src="form_40.png"/> become a general coordinate in Hamiltonian with corresponding general momentum <img class="formulaInl" alt="$Pt$" src="form_41.png"/>. The integration of the equation of motion then depends on the new differential variable <img class="formulaInl" alt="$ s$" src="form_42.png"/>. In this case, time and the motion of the system can be integrated with a fixed step size of s, which allow the usage of sympletic methods.</p>
<h2><a class="anchor" id="H_sec"></a>
Hamiltonian in Extended Phase Space</h2>
<p>Defining the general coordinates as <img class="formulaInl" alt="$ \mathbf{q} = \{q_i\}, (i=1,n) $" src="form_43.png"/> with freedom of <img class="formulaInl" alt="$n$" src="form_44.png"/> and corresponding general momentums ad <img class="formulaInl" alt="$ \mathbf{p} $" src="form_45.png"/>, The Hamiltonian equations is:</p>
<p>(1) <img class="formulaInl" alt="$ \frac{d \mathbf{q}}{d t} = \frac{\partial H}{\partial \mathbf{p}}$" src="form_46.png"/>; <img class="formulaInl" alt="$ \frac{d \mathbf{p}}{d t} = - \frac{\partial H}{\partial \mathbf{q}} $" src="form_47.png"/></p>
<p>Here the dt is used as a differetial varaible. For the propuse as we discussed above, we want to use a new variable s replacing the function of time <img class="formulaInl" alt="$t$" src="form_40.png"/>. In this case, the time is treated as a new general coordinate. And the corresponding time momentum <img class="formulaInl" alt="$Pt$" src="form_41.png"/> should be also added.</p>
<p>We extend the coordiantes to <img class="formulaInl" alt="$ \mathbf{Q} = (t, \mathbf{q}) $" src="form_48.png"/> and the momentums to <img class="formulaInl" alt="$ \mathbf{P} = (Pt, \mathbf{p})$" src="form_49.png"/> with total freedom of <img class="formulaInl" alt="$2(n+1)$" src="form_50.png"/>.</p>
<p>The new Hamiltonian <img class="formulaInl" alt="$H'$" src="form_51.png"/> should also satisfy the Hamiltonian equations (1). Especially for <img class="formulaInl" alt="$(t, Pt)$" src="form_52.png"/>, we can get:</p>
<p>(2) <img class="formulaInl" alt="$ \frac{d t}{d t} = \frac{\partial H'}{\partial Pt} = 1 $" src="form_53.png"/>; <img class="formulaInl" alt="$ \frac{d Pt}{d t} = - \frac{\partial H'}{\partial t} = - \frac{\partial H}{\partial t}$" src="form_54.png"/></p>
<p>From first equation of (2), we find the <img class="formulaInl" alt="$H'$" src="form_51.png"/> linearly depend on <img class="formulaInl" alt="$Pt$" src="form_41.png"/>, thus <img class="formulaInl" alt="$H'$" src="form_51.png"/> can be the form as <img class="formulaInl" alt="$ H' = H + Pt $" src="form_55.png"/>. The second equation indicates that the time evolution of <img class="formulaInl" alt="$Pt$" src="form_41.png"/> is equal to the negative energy change of the system. Thus the value of <img class="formulaInl" alt="$Pt$" src="form_41.png"/> at the time <img class="formulaInl" alt="$t$" src="form_40.png"/> can be <img class="formulaInl" alt="$-H(t)$" src="form_56.png"/>.</p>
<p>We want to write Hamiltonian equations with new differetial variable <img class="formulaInl" alt="$ ds$" src="form_57.png"/>. Defining <img class="formulaInl" alt="$ g(\mathbf{Q},\mathbf{P}) = \frac{dt}{ds} $" src="form_58.png"/>, we can rewrite (1) with <img class="formulaInl" alt="$ds$" src="form_59.png"/> and extended coordinates <img class="formulaInl" alt="$(\mathbf{Q}, \mathbf{P})$" src="form_60.png"/> as:</p>
<p>(3) <img class="formulaInl" alt="$ \frac{d \mathbf{Q}}{d s} = g(\mathbf{Q},\mathbf{P}) \frac{\partial H'}{\partial \mathbf{P}} $" src="form_61.png"/>; <img class="formulaInl" alt="$ \frac{d \mathbf{P}}{d s} = - g(\mathbf{Q},\mathbf{P}) \frac{\partial H'}{\partial \mathbf{Q}} $" src="form_62.png"/></p>
<p>However, we need to have the Hamiltonian equations the same form as original, thus we need to find another Hamiltonian <img class="formulaInl" alt="$\Gamma(\mathbf{P},\mathbf{Q})$" src="form_63.png"/> that satisfy the Hamiltonian equations:</p>
<p>(4) <img class="formulaInl" alt="$ \frac{d \mathbf{Q}}{d s} = \frac{\partial \Gamma}{\partial \mathbf{P}} $" src="form_64.png"/>; <img class="formulaInl" alt="$ \frac{d \mathbf{P}}{d s} = -\frac{\partial \Gamma}{\partial \mathbf{Q}} $" src="form_65.png"/></p>
<p>To find correct <img class="formulaInl" alt="$\Gamma(\mathbf{P},\mathbf{Q})$" src="form_63.png"/>, we go back to the Principle of least action which is used to derive the Lagrangian equations. The relation between (standard) Hamiltonian <img class="formulaInl" alt="$H(\mathbf{p},\mathbf{q},t)$" src="form_66.png"/> and Lagrangian <img class="formulaInl" alt="$L(\mathbf{p},\mathbf{q},t)$" src="form_67.png"/> is</p>
<p>(5) <img class="formulaInl" alt="$ H(\mathbf{p},\mathbf{q},t) = \sum_{i=1}^n p_i \dot{q_i} - L(\mathbf{p},\mathbf{q},t) $" src="form_68.png"/></p>
<p>The Principle of least action require the action</p>
<p>(6) <img class="formulaInl" alt="$ S = \int_{t_1}^{t_2} L(\mathbf{p},\mathbf{q},t) dt = \int_{t_1}^{t_2} \left[ \sum_{i=1}^n p_i \dot{q_i} - H(\mathbf{p},\mathbf{q},t) \right] dt $" src="form_69.png"/></p>
<p>should take the mimimum path, thus any function variation <img class="formulaInl" alt="$ \delta S $" src="form_70.png"/> should makes <img class="formulaInl" alt="$ S + \delta S$" src="form_71.png"/> increase. Thus when <img class="formulaInl" alt="$ \delta L(\mathbf{p},\mathbf{q},t) = 0 $" src="form_72.png"/>, this condition is satisfied. This leads to the Lagrangian equations and also the Hamitonian equations.</p>
<p>Here the integration takes from <img class="formulaInl" alt="$ t_1 $" src="form_73.png"/> to <img class="formulaInl" alt="$ t_2 $" src="form_74.png"/> and the time is used as integration variable. Now we treat (t, Pt) as new coordinate and momemtum, H' as new Hamitonian, and use s as new integration variable. Then <img class="formulaInl" alt="$S$" src="form_75.png"/> can be rewrited as:</p>
<p>(7) <img class="formulaInl" alt="$ S = \int_{s_1}^{s_2} \left[ \sum_{i=1}^n p_i \frac{d q_i} {d s} + Pt \frac{d t}{d s} - (H(\mathbf{p},\mathbf{q},t) + Pt) \frac{d t}{d s} \right] ds = \int_{s_1}^{s_2} \left[ \sum_{i=1}^{n+1} P_i \frac{d Q_i}{d s} - H'(\mathbf{P},\mathbf{Q}) \frac{d t}{d s}\right] ds $" src="form_76.png"/></p>
<p>It is obvious that when</p>
<p>(8) <img class="formulaInl" alt="$ \Gamma(\mathbf{P},\mathbf{Q}) = H'(\mathbf{P},\mathbf{Q}) \frac{d t}{d s} = g(\mathbf{Q},\mathbf{P}) (H(\mathbf{p},\mathbf{q},t) + Pt) $" src="form_77.png"/></p>
<p>The formula (7) become the same form as (6). Then with Principle of least action, the Hamiltonian equation (4) can be derived. We call the <img class="formulaInl" alt="$ \Gamma(\mathbf{P},\mathbf{Q}) $" src="form_78.png"/> is the Hamiltonian in the extended phase space <img class="formulaInl" alt="$ (\mathbf{P},\mathbf{Q}) $" src="form_79.png"/></p>
<p>The Hamiltonian in extended phase space <img class="formulaInl" alt="$\Gamma$" src="form_80.png"/> is also useful for analyzing the systems where Hamiltonian <img class="formulaInl" alt="$H$" src="form_81.png"/> explicitly depends on time and is not conserved. Since time become a coordinate in <img class="formulaInl" alt="$\Gamma$" src="form_80.png"/>, <img class="formulaInl" alt="$\frac{\partial \Gamma}{\partial s}$" src="form_82.png"/> is zero thus <img class="formulaInl" alt="$ \Gamma$" src="form_83.png"/> become conserved quantity. The method dealing with closed system can be used with Hamiltonian in extended phase space.</p>
<h2><a class="anchor" id="T_sec"></a>
Time transformation for Separable Hamiltonian</h2>
<p>With the Hamiltonian in extended phase space, we can integrate the equation of motions with step <img class="formulaInl" alt="$ ds $" src="form_84.png"/> by choosing a kind of <img class="formulaInl" alt="$g(\mathbf{Q},\mathbf{P})$" src="form_85.png"/>. If we choose a <img class="formulaInl" alt="$g(\mathbf{Q},\mathbf{P})$" src="form_85.png"/> that makes the Hamiltonian <img class="formulaInl" alt="$\Gamma(\mathbf{Q},\mathbf{P})$" src="form_86.png"/> separable for <img class="formulaInl" alt="$P$" src="form_87.png"/> and <img class="formulaInl" alt="$Q$" src="form_88.png"/>:</p>
<p>(9) <img class="formulaInl" alt="$ \Gamma(\mathbf{Q},\mathbf{P}) = a(\mathbf{P}) + b(\mathbf{Q}) $" src="form_89.png"/></p>
<p>Then explicit Leapfrog (SIA) integration method can be used. Preto &amp; Tremaine (1999) suggests to use</p>
<p>(10) <img class="formulaInl" alt="$ g(\mathbf{Q},\mathbf{P}) = \frac{f(T(\mathbf{P})) - f(-U(\mathbf{Q}))}{T(\mathbf{P}) + U(\mathbf{Q})} $" src="form_90.png"/></p>
<p>where <img class="formulaInl" alt="$ T(\mathbf{P}) = T(\mathbf{p}) + Pt $" src="form_91.png"/> is the extended kinetic energy and <img class="formulaInl" alt="$ U(\mathbf{Q}) = U(\mathbf{q},t) $" src="form_92.png"/> is the extended potential energy.</p>
<p>The Hamiltonian becomes separable:</p>
<p>(11) <img class="formulaInl" alt="$ \Gamma = f(T(\mathbf{P})) - f(-U(\mathbf{Q})) $" src="form_93.png"/></p>
<p>Then the equation of motions are:</p>
<p>(12) <img class="formulaInl" alt="$ \frac{d \mathbf{q} }{d s} = f'(T(\mathbf{p})+Pt) \frac{\partial T(\mathbf{p})}{\partial {\mathbf{p}}} $" src="form_94.png"/>; <img class="formulaInl" alt="$ \frac{d t }{d s} = f'(T(\mathbf{p})+Pt) $" src="form_95.png"/>; <img class="formulaInl" alt="$ \frac{d \mathbf{p} }{d s} = f'(-U(\mathbf{q},t)) \frac{\partial U(\mathbf{q},t)}{\partial {\mathbf{q}}} $" src="form_96.png"/>; <img class="formulaInl" alt="$ \frac{d Pt}{d s} = f'(-U(\mathbf{q},t)) \frac{\partial U(\mathbf{q},t)}{\partial {\mathbf{t}}} $" src="form_97.png"/>;</p>
<p>Since <img class="formulaInl" alt="$Pt = -H(t)$" src="form_98.png"/>, <img class="formulaInl" alt="$H'=H+Pt = T(\mathbf{P}) + U(\mathbf{Q}) = 0 $" src="form_99.png"/>. Thus during integration, <img class="formulaInl" alt="$T(\mathbf{P}) \approx -U(\mathbf{Q}) $" src="form_100.png"/>. This requires <img class="formulaInl" alt="$ f(T(\mathbf{P})) - f(-U(\mathbf{Q})) \approx 0 $" src="form_101.png"/>. With Taylor expansion, we can obtain:</p>
<p>(13) <img class="formulaInl" alt="$ f(T(\mathbf{P})) = f(-U(\mathbf{Q})) + \left[T(\mathbf{P}) + U(\mathbf{Q})\right] f'(-U(\mathbf{Q})) + O\left[T(\mathbf{P}) + U(\mathbf{Q})\right]^2 $" src="form_102.png"/></p>
<p>Thus <img class="formulaInl" alt="$ g(\mathbf{Q},\mathbf{P}) \approx f'(-U(\mathbf{Q})) $" src="form_103.png"/></p>
<h3><a class="anchor" id="logH_sec"></a>
Logarithmic Hamintonian method</h3>
<p>Mikkola &amp; Tanikawa (1999) suggests to use the function <img class="formulaInl" alt="$ f(x) = \log{x} $" src="form_104.png"/> (Logarithmic Hamintonian method). </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.12 </li>
  </ul>
</div>
</body>
</html>
