\hypertarget{classARC_1_1chainpars}{}\section{A\+RC\+:\+:chainpars Class Reference}
\label{classARC_1_1chainpars}\index{A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}}


The chain parameter controller class.  




{\ttfamily \#include $<$A\+R.\+h$>$}

\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classARC_1_1chainpars_a2019a609d85e2b801f306ac8c7f268ab}{chainpars} ()
\begin{DoxyCompactList}\small\item\em constructor with defaulted parameters \end{DoxyCompactList}\item 
\hyperlink{classARC_1_1chainpars_aa41e5cf2a9a8dea2c9c097cfd08d6120}{chainpars} (const double a, const double b, const double g, const double error=1\+E-\/10, const double dtm=5.\+4e-\/20, const double dte=1e-\/6, const int itermax=20, const int ext\+\_\+method=2, const int ext\+\_\+sequence=2, const int dense\+\_\+intpmax=10, const bool ext\+\_\+iteration\+\_\+const=false)
\begin{DoxyCompactList}\small\item\em constructor \end{DoxyCompactList}\item 
\hyperlink{classARC_1_1chainpars_a032873f782645efb6e60dc77f6d425dc}{$\sim$chainpars} ()
\begin{DoxyCompactList}\small\item\em destructor \end{DoxyCompactList}\item 
{\footnotesize template$<$class particle\+\_\+ , class pertparticle\+\_\+ , class pertforce\+\_\+ , class extpar\+\_\+ $>$ }\\void \hyperlink{classARC_1_1chainpars_ab66fadaa08cb449e1b49dd58e2d4b14f}{setA} (\hyperlink{namespaceARC_afc1f57a75859038cbd2492366fd1849c}{pair\+\_\+\+AW}$<$ particle\+\_\+, extpar\+\_\+ $>$ aw, \hyperlink{namespaceARC_aa423c7d6aff9481c040a20b3c5c6ff4e}{ext\+\_\+\+Acc}$<$ particle\+\_\+, pertparticle\+\_\+, pertforce\+\_\+, extpar\+\_\+ $>$ exta=N\+U\+LL, \hyperlink{namespaceARC_af6dbf77cf2968752315f7712eb2515a3}{pair\+\_\+T}$<$ particle\+\_\+, extpar\+\_\+ $>$ at=N\+U\+LL)
\begin{DoxyCompactList}\small\item\em Set acceleration, potential, time transformation function $\partial W/\partial r$ and $W$ calculator. \end{DoxyCompactList}\item 
void \hyperlink{classARC_1_1chainpars_a37f8af288217cbfc61a3593e21976d06}{setabg} (const double a=1.\+0, const double b=0.\+0, const double g=0.\+0)
\begin{DoxyCompactList}\small\item\em Set time step transformation parameter. \end{DoxyCompactList}\item 
void \hyperlink{classARC_1_1chainpars_ad294bf8a2f7f5a20e554d4a9cb2c3e4c}{getabg} (double \&a, double \&b, double \&g) const
\begin{DoxyCompactList}\small\item\em Get time step transformation parameter. \end{DoxyCompactList}\item 
void \hyperlink{classARC_1_1chainpars_a59709cc9464bed3a17f99cf3fd611ad3}{set\+Err} (const double error=1\+E-\/10, const double dtm=5.\+4e-\/20, const double dte=1e-\/6)
\begin{DoxyCompactList}\small\item\em Set error paremeters. \end{DoxyCompactList}\item 
void \hyperlink{classARC_1_1chainpars_ae5946e3523a7e72d38f579e900dd20e5}{set\+Intp} (const int method=2)
\begin{DoxyCompactList}\small\item\em Set interpolation method. \end{DoxyCompactList}\item 
const int \hyperlink{classARC_1_1chainpars_aad612e3c643bdd642245397d7dc57d94}{get\+Intp} () const
\begin{DoxyCompactList}\small\item\em Get interpolation method index. \end{DoxyCompactList}\item 
void \hyperlink{classARC_1_1chainpars_acee4adb70778441325e76eedbdbe6343}{set\+Iter\+Const} (const bool ext\+\_\+iteration\+\_\+const=false)
\begin{DoxyCompactList}\small\item\em Set whether to use constant iteration number in extrapolation integration. \end{DoxyCompactList}\item 
void \hyperlink{classARC_1_1chainpars_a58bf0df2cd23671e3e4651e9fe87ddae}{set\+Iter\+Seq} (const int itermax=20, const int sequence=2, const int intpmax=0)
\begin{DoxyCompactList}\small\item\em Set extrapolation maximum iteration number and sequences. \end{DoxyCompactList}\item 
void \hyperlink{classARC_1_1chainpars_a53ef5c1f0077aee49c110982f69ced9c}{set\+Den\+Intpmax} (const int intpmax)
\begin{DoxyCompactList}\small\item\em set maximum derivate index for dense output interpolation \end{DoxyCompactList}\item 
const int \hyperlink{classARC_1_1chainpars_a394aa470175760d3e1f518b68067c9dc}{get\+Den\+Intpmax} () const
\begin{DoxyCompactList}\small\item\em Get maximum derivate index for dense output interpolation. \end{DoxyCompactList}\item 
const int \hyperlink{classARC_1_1chainpars_aea815f20c4efe8e93d68153e41275770}{get\+Seq} () const
\begin{DoxyCompactList}\small\item\em Get sequence method indices. \end{DoxyCompactList}\item 
const int \hyperlink{classARC_1_1chainpars_a000356820943c99de5542b04130f453f}{get\+Iter} () const
\begin{DoxyCompactList}\small\item\em Get extrapolation maximum iteration times (maximum sequence index) \end{DoxyCompactList}\item 
void \hyperlink{classARC_1_1chainpars_a049e663206a8fba9bc0abc7a0be805eb}{set\+Auto\+Step} (const int option, const double factor\+\_\+min=0.\+7, const double factor\+\_\+max=1.\+3, const double eps=0.\+5, const int iter\+\_\+min=5, const int iter\+\_\+max=17)
\begin{DoxyCompactList}\small\item\em Determine auto-\/step parameter. \end{DoxyCompactList}\item 
void \hyperlink{classARC_1_1chainpars_a9758b3d019bd02f2fd27614c99d7fc84}{get\+Auto\+Step} (int \&option, double \&factor\+\_\+min, double \&factor\+\_\+max, double \&eps, int \&iter\+\_\+min, int \&iter\+\_\+max) const
\begin{DoxyCompactList}\small\item\em Get auto-\/step parameters. \end{DoxyCompactList}\item 
void \hyperlink{classARC_1_1chainpars_a926438a652307d24bd8a03b0ca926382}{dump} (const char $\ast$filename) const
\begin{DoxyCompactList}\small\item\em parameters dumping \end{DoxyCompactList}\item 
void \hyperlink{classARC_1_1chainpars_a68f92497bf003803c01fee179d0db68f}{read} (const char $\ast$filename)
\begin{DoxyCompactList}\small\item\em parameters loading from a dumped file \end{DoxyCompactList}\item 
void \hyperlink{classARC_1_1chainpars_a3bd667353d49614c52ad6c965a7480f3}{print} (std\+::ostream \&fout)
\begin{DoxyCompactList}\small\item\em Print parameter table. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{classARC_1_1chainpars_ac414014d19915aecb35245ba11649c2e}{dtmin}
\begin{DoxyCompactList}\small\item\em minimum physical time step \end{DoxyCompactList}\item 
double \hyperlink{classARC_1_1chainpars_ad3a3e8f9199180ec82b9c257b1e8570e}{dterr}
\begin{DoxyCompactList}\small\item\em physical time error criterion \end{DoxyCompactList}\item 
double \hyperlink{classARC_1_1chainpars_a7ee477ebe8b1d67457891ab58560c074}{exp\+\_\+error}
\begin{DoxyCompactList}\small\item\em relative error requirement for extrapolation \end{DoxyCompactList}\item 
bool \hyperlink{classARC_1_1chainpars_a3f16e6ea9497e294265c4a17df0394ba}{exp\+\_\+fix\+\_\+iter}
\begin{DoxyCompactList}\small\item\em flag showing whether the times of iteration is fixed or not \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Friends}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$class T $>$ }\\class \hyperlink{classARC_1_1chainpars_a498fbb4337b9878a5f0044996e4a2489}{chain}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
The chain parameter controller class. 

This class control acceleration function, integration methods and error parameters for \hyperlink{classARC_1_1chain}{chain} 

\subsection{Constructor \& Destructor Documentation}
\hypertarget{classARC_1_1chainpars_a2019a609d85e2b801f306ac8c7f268ab}{}\label{classARC_1_1chainpars_a2019a609d85e2b801f306ac8c7f268ab} 
\index{A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}!chainpars@{chainpars}}
\index{chainpars@{chainpars}!A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}}
\subsubsection{\texorpdfstring{chainpars()}{chainpars()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily A\+R\+C\+::chainpars\+::chainpars (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



constructor with defaulted parameters 


\begin{DoxyItemize}
\item \hyperlink{namespaceARC}{A\+RC} method use logarithmic Hamiltonian (logH) (\#alpha = 1.\+0, \#beta = 0.\+0 \#gamma = 0.\+0).
\item Phase/energy error limit \hyperlink{classARC_1_1chainpars_a7ee477ebe8b1d67457891ab58560c074}{exp\+\_\+error} = 1e-\/10.
\item Minimum physical time step \hyperlink{classARC_1_1chainpars_ac414014d19915aecb35245ba11649c2e}{dtmin} = 5.\+4e-\/20.
\item Time synchronization (relative to time step) physical time error limit \hyperlink{classARC_1_1chainpars_ad3a3e8f9199180ec82b9c257b1e8570e}{dterr} = 1e-\/6.
\item Maximum extrapolation sequence index (accuracy order/iteration times) \#exp\+\_\+itermax = 20
\item The maximum sequence index (iteration times) is adjusted by error criterion
\item Bulirsch \& Stoer sequence \{h, h/2, h/3, h/4, h/6...\} is used
\item No auto-\/step 
\end{DoxyItemize}\hypertarget{classARC_1_1chainpars_aa41e5cf2a9a8dea2c9c097cfd08d6120}{}\label{classARC_1_1chainpars_aa41e5cf2a9a8dea2c9c097cfd08d6120} 
\index{A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}!chainpars@{chainpars}}
\index{chainpars@{chainpars}!A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}}
\subsubsection{\texorpdfstring{chainpars()}{chainpars()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily A\+R\+C\+::chainpars\+::chainpars (\begin{DoxyParamCaption}\item[{const double}]{a,  }\item[{const double}]{b,  }\item[{const double}]{g,  }\item[{const double}]{error = {\ttfamily 1E-\/10},  }\item[{const double}]{dtm = {\ttfamily 5.4e-\/20},  }\item[{const double}]{dte = {\ttfamily 1e-\/6},  }\item[{const int}]{itermax = {\ttfamily 20},  }\item[{const int}]{ext\+\_\+method = {\ttfamily 2},  }\item[{const int}]{ext\+\_\+sequence = {\ttfamily 2},  }\item[{const int}]{dense\+\_\+intpmax = {\ttfamily 10},  }\item[{const bool}]{ext\+\_\+iteration\+\_\+const = {\ttfamily false} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



constructor 

All parameters can be set except anto-\/step method (defaulted is zero) 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em a,b,g} & \hyperlink{namespaceARC}{A\+RC} time transformation method coefficients ( $ dt = ds/[a *(logH) + b * (TTL) + g])$. ~\newline

\begin{DoxyItemize}
\item a\+: Logarithmic Hamiltonian (logH) method coefficient \#alpha (0.\+0, 1.\+0)
\item b\+: Time-\/\+Transformed Leapfrog (T\+TL) method coefficient \#beta (0.\+0, 1.\+0)
\item g\+: Constant coefficient (no time transformation) \#gamma 
\end{DoxyItemize}\\
\hline
\mbox{\tt in}  & {\em error} & Phase/energy error limit (defaulted \hyperlink{classARC_1_1chainpars_a7ee477ebe8b1d67457891ab58560c074}{exp\+\_\+error} = 1e-\/10) \\
\hline
\mbox{\tt in}  & {\em dtm} & Minimum physical time step (defaulted \hyperlink{classARC_1_1chainpars_ac414014d19915aecb35245ba11649c2e}{dtmin} = 5.\+4e-\/20) \\
\hline
\mbox{\tt in}  & {\em dte} & Relative time synchronization error limit (defaulted \hyperlink{classARC_1_1chainpars_ad3a3e8f9199180ec82b9c257b1e8570e}{dterr} = 1e-\/6) \\
\hline
\mbox{\tt in}  & {\em itermax} & Maximum extrapolation sequence index (accuracy order/iteration times) (defaulted \#exp\+\_\+itermax = 20) \\
\hline
\mbox{\tt in}  & {\em ext\+\_\+method} & 1\+: Polynomial interpolation method; others\+: Rational interpolation method (defaulted\+: Rational) \\
\hline
\mbox{\tt in}  & {\em ext\+\_\+sequence} & 1\+: Romberg sequence \{h, h/2, h/4, h/8 ...\}; 2\+: Bulirsch \& Stoer (BS) sequence \{h, h/2, h/3, h/4, h/6, h/8 ...\}; 3\+: 4k sequence \{h, h/2, h/6, h/10, h/14 ...\}; others\+: Harmonic sequence \{h, h/2, h/3, h/4 ...\} (defaulted 2. BS sequence) \\
\hline
\mbox{\tt in}  & {\em dense\+\_\+intpmax} & maximum derivate index for dense output interpolation (defaulted \#itermax/2) \\
\hline
\mbox{\tt in}  & {\em ext\+\_\+iteration\+\_\+const} & true\+: the maximum sequence index (iteration times) is fixed to itermax; false\+: adjust the maximum sequence index by error criterion (false) \\
\hline
\end{DoxyParams}
\hypertarget{classARC_1_1chainpars_a032873f782645efb6e60dc77f6d425dc}{}\label{classARC_1_1chainpars_a032873f782645efb6e60dc77f6d425dc} 
\index{A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}!````~chainpars@{$\sim$chainpars}}
\index{````~chainpars@{$\sim$chainpars}!A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}}
\subsubsection{\texorpdfstring{$\sim$chainpars()}{~chainpars()}}
{\footnotesize\ttfamily A\+R\+C\+::chainpars\+::$\sim$chainpars (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



destructor 



\subsection{Member Function Documentation}
\hypertarget{classARC_1_1chainpars_a926438a652307d24bd8a03b0ca926382}{}\label{classARC_1_1chainpars_a926438a652307d24bd8a03b0ca926382} 
\index{A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}!dump@{dump}}
\index{dump@{dump}!A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}}
\subsubsection{\texorpdfstring{dump()}{dump()}}
{\footnotesize\ttfamily void A\+R\+C\+::chainpars\+::dump (\begin{DoxyParamCaption}\item[{const char $\ast$}]{filename }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



parameters dumping 

Dump parameters into file. Notice dynamic array data will not be dumped. The dumping data includes\+: \#alpha, \#beta, \#gamma, \#exp\+\_\+method, \#exp\+\_\+sequence, \#exp\+\_\+itermax, \hyperlink{classARC_1_1chainpars_a7ee477ebe8b1d67457891ab58560c074}{exp\+\_\+error}, \hyperlink{classARC_1_1chainpars_a3f16e6ea9497e294265c4a17df0394ba}{exp\+\_\+fix\+\_\+iter}, \hyperlink{classARC_1_1chainpars_ac414014d19915aecb35245ba11649c2e}{dtmin}, \hyperlink{classARC_1_1chainpars_ad3a3e8f9199180ec82b9c257b1e8570e}{dterr}, \#auto\+\_\+step, auto\+\_\+step parameters 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em filename} & file for storing the data \\
\hline
\end{DoxyParams}
\hypertarget{classARC_1_1chainpars_ad294bf8a2f7f5a20e554d4a9cb2c3e4c}{}\label{classARC_1_1chainpars_ad294bf8a2f7f5a20e554d4a9cb2c3e4c} 
\index{A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}!getabg@{getabg}}
\index{getabg@{getabg}!A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}}
\subsubsection{\texorpdfstring{getabg()}{getabg()}}
{\footnotesize\ttfamily void A\+R\+C\+::chainpars\+::getabg (\begin{DoxyParamCaption}\item[{double \&}]{a,  }\item[{double \&}]{b,  }\item[{double \&}]{g }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Get time step transformation parameter. 

Get parameter a,b,g where physical time step $ dt = ds/[a *(logH) + b * (TTL) + g]$ ~\newline

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em a} & Logarithmic Hamiltonian (logH) method coefficient \#alpha (0.\+0, 1.\+0) \\
\hline
\mbox{\tt in}  & {\em b} & Time-\/\+Transformed Leapfrog (T\+TL) method coefficient \#beta (0.\+0, 1.\+0) \\
\hline
\mbox{\tt in}  & {\em g} & Constant coefficient (no time transformation) \#gamma \\
\hline
\end{DoxyParams}
\hypertarget{classARC_1_1chainpars_a9758b3d019bd02f2fd27614c99d7fc84}{}\label{classARC_1_1chainpars_a9758b3d019bd02f2fd27614c99d7fc84} 
\index{A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}!get\+Auto\+Step@{get\+Auto\+Step}}
\index{get\+Auto\+Step@{get\+Auto\+Step}!A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}}
\subsubsection{\texorpdfstring{get\+Auto\+Step()}{getAutoStep()}}
{\footnotesize\ttfamily void A\+R\+C\+::chainpars\+::get\+Auto\+Step (\begin{DoxyParamCaption}\item[{int \&}]{option,  }\item[{double \&}]{factor\+\_\+min,  }\item[{double \&}]{factor\+\_\+max,  }\item[{double \&}]{eps,  }\item[{int \&}]{iter\+\_\+min,  }\item[{int \&}]{iter\+\_\+max }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Get auto-\/step parameters. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em option} & auto-\/step method
\begin{DoxyItemize}
\item 0. no auto-\/step
\item 1. use extrapolation error to estimate next step
\item 2. use min( $X/(gV)$, $V/(gA)$) to estimate next step
\item 3\+: use maximum sequence index to control next step. If index $>${\itshape iter\+\_\+max}, modification factor = {\itshape factor\+\_\+min}; if index $<$ {\itshape iter\+\_\+min}, modification factor = {\itshape factor\+\_\+max};
\item 4\+: use mimimum user-\/defined two-\/body timescale of every two neigbor members to estimate next step 
\end{DoxyItemize}\\
\hline
\mbox{\tt in}  & {\em factor\+\_\+min} & if {\itshape option} = 1-\/$>$3, it is the minimum step reduction factor (defaulted\+: 0.\+7) \\
\hline
\mbox{\tt in}  & {\em factor\+\_\+max} & if {\itshape option} = 1-\/$>$3, it is the maximum step reduction factor (defaulted\+: 1.\+3) \\
\hline
\mbox{\tt in}  & {\em eps} & coefficient. If {\itshape option} = 2 or 4, coefficient is the multiplying factor for the estimated next step (defaulted\+: 0.\+125) \\
\hline
\mbox{\tt in}  & {\em iter\+\_\+min} & if {\itshape option} = 3, it is the minimum sequence index (iteration times) criterion during extrapolation intergration (defaulted\+: 5) \\
\hline
\mbox{\tt in}  & {\em iter\+\_\+max} & if {\itshape option} = 3, it is the maximum sequence index (iteration times) criterion during extrapolation intergration (defaulted\+: 17) \\
\hline
\end{DoxyParams}
\hypertarget{classARC_1_1chainpars_a394aa470175760d3e1f518b68067c9dc}{}\label{classARC_1_1chainpars_a394aa470175760d3e1f518b68067c9dc} 
\index{A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}!get\+Den\+Intpmax@{get\+Den\+Intpmax}}
\index{get\+Den\+Intpmax@{get\+Den\+Intpmax}!A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}}
\subsubsection{\texorpdfstring{get\+Den\+Intpmax()}{getDenIntpmax()}}
{\footnotesize\ttfamily const int A\+R\+C\+::chainpars\+::get\+Den\+Intpmax (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Get maximum derivate index for dense output interpolation. 

\begin{DoxyReturn}{Returns}
maximum derivate index for dense ouput interpolation (defaulted \#itermax/2) 
\end{DoxyReturn}
\hypertarget{classARC_1_1chainpars_aad612e3c643bdd642245397d7dc57d94}{}\label{classARC_1_1chainpars_aad612e3c643bdd642245397d7dc57d94} 
\index{A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}!get\+Intp@{get\+Intp}}
\index{get\+Intp@{get\+Intp}!A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}}
\subsubsection{\texorpdfstring{get\+Intp()}{getIntp()}}
{\footnotesize\ttfamily const int A\+R\+C\+::chainpars\+::get\+Intp (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Get interpolation method index. 

\begin{DoxyReturn}{Returns}
method index\+: 1\+: Polynomial method; others\+: Rational interpolation method (defaulted Rational) 
\end{DoxyReturn}
\hypertarget{classARC_1_1chainpars_a000356820943c99de5542b04130f453f}{}\label{classARC_1_1chainpars_a000356820943c99de5542b04130f453f} 
\index{A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}!get\+Iter@{get\+Iter}}
\index{get\+Iter@{get\+Iter}!A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}}
\subsubsection{\texorpdfstring{get\+Iter()}{getIter()}}
{\footnotesize\ttfamily const int A\+R\+C\+::chainpars\+::get\+Iter (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Get extrapolation maximum iteration times (maximum sequence index) 

\hypertarget{classARC_1_1chainpars_aea815f20c4efe8e93d68153e41275770}{}\label{classARC_1_1chainpars_aea815f20c4efe8e93d68153e41275770} 
\index{A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}!get\+Seq@{get\+Seq}}
\index{get\+Seq@{get\+Seq}!A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}}
\subsubsection{\texorpdfstring{get\+Seq()}{getSeq()}}
{\footnotesize\ttfamily const int A\+R\+C\+::chainpars\+::get\+Seq (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Get sequence method indices. 

\hypertarget{classARC_1_1chainpars_a3bd667353d49614c52ad6c965a7480f3}{}\label{classARC_1_1chainpars_a3bd667353d49614c52ad6c965a7480f3} 
\index{A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}!print@{print}}
\index{print@{print}!A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}}
\subsubsection{\texorpdfstring{print()}{print()}}
{\footnotesize\ttfamily void A\+R\+C\+::chainpars\+::print (\begin{DoxyParamCaption}\item[{std\+::ostream \&}]{fout }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Print parameter table. 

Print parameter table 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em fout} & ofstream for printing \\
\hline
\end{DoxyParams}
\hypertarget{classARC_1_1chainpars_a68f92497bf003803c01fee179d0db68f}{}\label{classARC_1_1chainpars_a68f92497bf003803c01fee179d0db68f} 
\index{A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}!read@{read}}
\index{read@{read}!A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}}
\subsubsection{\texorpdfstring{read()}{read()}}
{\footnotesize\ttfamily void A\+R\+C\+::chainpars\+::read (\begin{DoxyParamCaption}\item[{const char $\ast$}]{filename }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



parameters loading from a dumped file 

Load parameters from a dumped file. All dynamical array will be initialized after reading parameters. Notice this function will load all parameters except acceleration function pointers \#pp\+\_\+\+AW and \#pp\+\_\+\+Ap. \hyperlink{classARC_1_1chainpars_ab66fadaa08cb449e1b49dd58e2d4b14f}{set\+A()} should be called before chain integration. The reading data list is shown in \hyperlink{classARC_1_1chainpars_a926438a652307d24bd8a03b0ca926382}{dump()} 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em filename} & file to read the data \\
\hline
\end{DoxyParams}
\hypertarget{classARC_1_1chainpars_ab66fadaa08cb449e1b49dd58e2d4b14f}{}\label{classARC_1_1chainpars_ab66fadaa08cb449e1b49dd58e2d4b14f} 
\index{A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}!setA@{setA}}
\index{setA@{setA}!A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}}
\subsubsection{\texorpdfstring{set\+A()}{setA()}}
{\footnotesize\ttfamily template$<$class particle\+\_\+ , class pertparticle\+\_\+ , class pertforce\+\_\+ , class extpar\+\_\+ $>$ \\
void A\+R\+C\+::chainpars\+::setA (\begin{DoxyParamCaption}\item[{\hyperlink{namespaceARC_afc1f57a75859038cbd2492366fd1849c}{pair\+\_\+\+AW}$<$ particle\+\_\+, extpar\+\_\+ $>$}]{aw,  }\item[{\hyperlink{namespaceARC_aa423c7d6aff9481c040a20b3c5c6ff4e}{ext\+\_\+\+Acc}$<$ particle\+\_\+, pertparticle\+\_\+, pertforce\+\_\+, extpar\+\_\+ $>$}]{exta = {\ttfamily NULL},  }\item[{\hyperlink{namespaceARC_af6dbf77cf2968752315f7712eb2515a3}{pair\+\_\+T}$<$ particle\+\_\+, extpar\+\_\+ $>$}]{at = {\ttfamily NULL} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Set acceleration, potential, time transformation function $\partial W/\partial r$ and $W$ calculator. 

Set acceleration, potential, time transformation function $\partial W/\partial r$ and $W$ for two particles. This is the basic functions used for interaction between chain members and from perturbers. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em aw} & acceleration, potential and time transformation function $\partial W/\partial r$, $W$ of two particles calculation function pointer with pair\+\_\+\+AW type. (interaction between memebrs). Notice this function defines $\partial W/\partial r$ and $W$, and these time transformation functions are only used when \#beta$>$0 (see \hyperlink{classARC_1_1chainpars_a37f8af288217cbfc61a3593e21976d06}{setabg()}). \\
\hline
\mbox{\tt in}  & {\em exta} & external force(acceleration) function pointer with ext\+\_\+\+Acc type \\
\hline
\mbox{\tt in}  & {\em at} & two-\/body timescale calculation function pointer with pair\+\_\+T type. (this will be used for new step size estimation) \\
\hline
\end{DoxyParams}
\hypertarget{classARC_1_1chainpars_a37f8af288217cbfc61a3593e21976d06}{}\label{classARC_1_1chainpars_a37f8af288217cbfc61a3593e21976d06} 
\index{A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}!setabg@{setabg}}
\index{setabg@{setabg}!A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}}
\subsubsection{\texorpdfstring{setabg()}{setabg()}}
{\footnotesize\ttfamily void A\+R\+C\+::chainpars\+::setabg (\begin{DoxyParamCaption}\item[{const double}]{a = {\ttfamily 1.0},  }\item[{const double}]{b = {\ttfamily 0.0},  }\item[{const double}]{g = {\ttfamily 0.0} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Set time step transformation parameter. 

Set parameter a,b,g where physical time step $ dt = ds/[a *(logH) + b * (TTL) + g]$ ~\newline

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em a} & Logarithmic Hamiltonian (logH) method coefficient \#alpha (0.\+0, 1.\+0) \\
\hline
\mbox{\tt in}  & {\em b} & Time-\/\+Transformed Leapfrog (T\+TL) method coefficient \#beta (0.\+0, 1.\+0) \\
\hline
\mbox{\tt in}  & {\em g} & Constant coefficient (no time transformation) \#gamma \\
\hline
\end{DoxyParams}
\hypertarget{classARC_1_1chainpars_a049e663206a8fba9bc0abc7a0be805eb}{}\label{classARC_1_1chainpars_a049e663206a8fba9bc0abc7a0be805eb} 
\index{A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}!set\+Auto\+Step@{set\+Auto\+Step}}
\index{set\+Auto\+Step@{set\+Auto\+Step}!A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}}
\subsubsection{\texorpdfstring{set\+Auto\+Step()}{setAutoStep()}}
{\footnotesize\ttfamily void A\+R\+C\+::chainpars\+::set\+Auto\+Step (\begin{DoxyParamCaption}\item[{const int}]{option,  }\item[{const double}]{factor\+\_\+min = {\ttfamily 0.7},  }\item[{const double}]{factor\+\_\+max = {\ttfamily 1.3},  }\item[{const double}]{eps = {\ttfamily 0.5},  }\item[{const int}]{iter\+\_\+min = {\ttfamily 5},  }\item[{const int}]{iter\+\_\+max = {\ttfamily 17} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Determine auto-\/step parameter. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em option} & auto-\/step method
\begin{DoxyItemize}
\item 0. no auto-\/step
\item 1. use extrapolation error to estimate next step
\item 2. use min( $X/(gV)$, $V/(gA)$) to estimate next step
\item 3\+: use maximum sequence index to control next step. If index $>${\itshape iter\+\_\+max}, modification factor = {\itshape factor\+\_\+min}; if index $<$ {\itshape iter\+\_\+min}, modification factor = {\itshape factor\+\_\+max};
\item 4\+: use mimimum user-\/defined two-\/body timescale of every two neigbor members to estimate next step 
\end{DoxyItemize}\\
\hline
\mbox{\tt in}  & {\em factor\+\_\+min} & if {\itshape option} = 1-\/$>$3, it is the minimum step reduction factor (defaulted\+: 0.\+7) \\
\hline
\mbox{\tt in}  & {\em factor\+\_\+max} & if {\itshape option} = 1-\/$>$3, it is the maximum step reduction factor (defaulted\+: 1.\+3) \\
\hline
\mbox{\tt in}  & {\em eps} & coefficient. If {\itshape option} = 2 or 4, coefficient is the multiplying factor for the estimated next step (defaulted\+: 0.\+125) \\
\hline
\mbox{\tt in}  & {\em iter\+\_\+min} & if {\itshape option} = 3, it is the minimum sequence index (iteration times) criterion during extrapolation intergration (defaulted\+: 5) \\
\hline
\mbox{\tt in}  & {\em iter\+\_\+max} & if {\itshape option} = 3, it is the maximum sequence index (iteration times) criterion during extrapolation intergration (defaulted\+: 17) \\
\hline
\end{DoxyParams}
\hypertarget{classARC_1_1chainpars_a53ef5c1f0077aee49c110982f69ced9c}{}\label{classARC_1_1chainpars_a53ef5c1f0077aee49c110982f69ced9c} 
\index{A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}!set\+Den\+Intpmax@{set\+Den\+Intpmax}}
\index{set\+Den\+Intpmax@{set\+Den\+Intpmax}!A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}}
\subsubsection{\texorpdfstring{set\+Den\+Intpmax()}{setDenIntpmax()}}
{\footnotesize\ttfamily void A\+R\+C\+::chainpars\+::set\+Den\+Intpmax (\begin{DoxyParamCaption}\item[{const int}]{intpmax }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



set maximum derivate index for dense output interpolation 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em intpmax} & maximum derivate index for dense ouput interpolation (defaulted \#itermax/2) \\
\hline
\end{DoxyParams}
\hypertarget{classARC_1_1chainpars_a59709cc9464bed3a17f99cf3fd611ad3}{}\label{classARC_1_1chainpars_a59709cc9464bed3a17f99cf3fd611ad3} 
\index{A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}!set\+Err@{set\+Err}}
\index{set\+Err@{set\+Err}!A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}}
\subsubsection{\texorpdfstring{set\+Err()}{setErr()}}
{\footnotesize\ttfamily void A\+R\+C\+::chainpars\+::set\+Err (\begin{DoxyParamCaption}\item[{const double}]{error = {\ttfamily 1E-\/10},  }\item[{const double}]{dtm = {\ttfamily 5.4e-\/20},  }\item[{const double}]{dte = {\ttfamily 1e-\/6} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Set error paremeters. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em error} & phase/energy relative error requirement for extrapolation (defaulted \hyperlink{classARC_1_1chainpars_a7ee477ebe8b1d67457891ab58560c074}{exp\+\_\+error} = 1e-\/10) \\
\hline
\mbox{\tt in}  & {\em dtm} & minimum physical time step allown (defaulted \hyperlink{classARC_1_1chainpars_ac414014d19915aecb35245ba11649c2e}{dtmin} = 5.\+4e-\/20) \\
\hline
\mbox{\tt in}  & {\em dte} & Time synchronization error limit (defaulted \hyperlink{classARC_1_1chainpars_ad3a3e8f9199180ec82b9c257b1e8570e}{dterr} = 1e-\/6) \\
\hline
\end{DoxyParams}
\hypertarget{classARC_1_1chainpars_ae5946e3523a7e72d38f579e900dd20e5}{}\label{classARC_1_1chainpars_ae5946e3523a7e72d38f579e900dd20e5} 
\index{A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}!set\+Intp@{set\+Intp}}
\index{set\+Intp@{set\+Intp}!A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}}
\subsubsection{\texorpdfstring{set\+Intp()}{setIntp()}}
{\footnotesize\ttfamily void A\+R\+C\+::chainpars\+::set\+Intp (\begin{DoxyParamCaption}\item[{const int}]{method = {\ttfamily 2} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Set interpolation method. 

Set interpolation method for extrapolation integration 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em method} & 1\+: Polynomial method; others\+: Rational interpolation method (defaulted Rational) \\
\hline
\end{DoxyParams}
\hypertarget{classARC_1_1chainpars_acee4adb70778441325e76eedbdbe6343}{}\label{classARC_1_1chainpars_acee4adb70778441325e76eedbdbe6343} 
\index{A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}!set\+Iter\+Const@{set\+Iter\+Const}}
\index{set\+Iter\+Const@{set\+Iter\+Const}!A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}}
\subsubsection{\texorpdfstring{set\+Iter\+Const()}{setIterConst()}}
{\footnotesize\ttfamily void A\+R\+C\+::chainpars\+::set\+Iter\+Const (\begin{DoxyParamCaption}\item[{const bool}]{ext\+\_\+iteration\+\_\+const = {\ttfamily false} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Set whether to use constant iteration number in extrapolation integration. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ext\+\_\+iteration\+\_\+const} & true\+: the maximum sequence index (iteration times) is fixed to itermax; false\+: adjust the maximum sequence index by error criterion (false) \\
\hline
\end{DoxyParams}
\hypertarget{classARC_1_1chainpars_a58bf0df2cd23671e3e4651e9fe87ddae}{}\label{classARC_1_1chainpars_a58bf0df2cd23671e3e4651e9fe87ddae} 
\index{A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}!set\+Iter\+Seq@{set\+Iter\+Seq}}
\index{set\+Iter\+Seq@{set\+Iter\+Seq}!A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}}
\subsubsection{\texorpdfstring{set\+Iter\+Seq()}{setIterSeq()}}
{\footnotesize\ttfamily void A\+R\+C\+::chainpars\+::set\+Iter\+Seq (\begin{DoxyParamCaption}\item[{const int}]{itermax = {\ttfamily 20},  }\item[{const int}]{sequence = {\ttfamily 2},  }\item[{const int}]{intpmax = {\ttfamily 0} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Set extrapolation maximum iteration number and sequences. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em itermax} & Maximum extrapolation sequence index (accuracy order/iteration times) (defaulted \#exp\+\_\+itermax = 20) \\
\hline
\mbox{\tt in}  & {\em sequence} & 1\+: Romberg sequence \{h, h/2, h/4, h/8 ...\}; 2\+: Bulirsch \& Stoer (BS) sequence \{h, h/2, h/3, h/4, h/6, h/8 ...\}; 3\+: 4k sequence \{h, h/2, h/6, h/10, h/14 ...\}; others\+: Harmonic sequence \{h, h/2, h/3, h/4 ...\} (defaulted 2. BS sequence) \\
\hline
\mbox{\tt in}  & {\em intpmax} & maximum derivate index for dense ouput interpolation (defaulted \#itermax/2) \\
\hline
\end{DoxyParams}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classARC_1_1chainpars_a58bf0df2cd23671e3e4651e9fe87ddae_cgraph}
\end{center}
\end{figure}


\subsection{Friends And Related Function Documentation}
\hypertarget{classARC_1_1chainpars_a498fbb4337b9878a5f0044996e4a2489}{}\label{classARC_1_1chainpars_a498fbb4337b9878a5f0044996e4a2489} 
\index{A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}!chain@{chain}}
\index{chain@{chain}!A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}}
\subsubsection{\texorpdfstring{chain}{chain}}
{\footnotesize\ttfamily template$<$class T $>$ \\
friend class \hyperlink{classARC_1_1chain}{chain}\hspace{0.3cm}{\ttfamily [friend]}}



\subsection{Member Data Documentation}
\hypertarget{classARC_1_1chainpars_ad3a3e8f9199180ec82b9c257b1e8570e}{}\label{classARC_1_1chainpars_ad3a3e8f9199180ec82b9c257b1e8570e} 
\index{A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}!dterr@{dterr}}
\index{dterr@{dterr}!A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}}
\subsubsection{\texorpdfstring{dterr}{dterr}}
{\footnotesize\ttfamily double A\+R\+C\+::chainpars\+::dterr}



physical time error criterion 

\hypertarget{classARC_1_1chainpars_ac414014d19915aecb35245ba11649c2e}{}\label{classARC_1_1chainpars_ac414014d19915aecb35245ba11649c2e} 
\index{A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}!dtmin@{dtmin}}
\index{dtmin@{dtmin}!A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}}
\subsubsection{\texorpdfstring{dtmin}{dtmin}}
{\footnotesize\ttfamily double A\+R\+C\+::chainpars\+::dtmin}



minimum physical time step 

\hypertarget{classARC_1_1chainpars_a7ee477ebe8b1d67457891ab58560c074}{}\label{classARC_1_1chainpars_a7ee477ebe8b1d67457891ab58560c074} 
\index{A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}!exp\+\_\+error@{exp\+\_\+error}}
\index{exp\+\_\+error@{exp\+\_\+error}!A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}}
\subsubsection{\texorpdfstring{exp\+\_\+error}{exp\_error}}
{\footnotesize\ttfamily double A\+R\+C\+::chainpars\+::exp\+\_\+error}



relative error requirement for extrapolation 

\hypertarget{classARC_1_1chainpars_a3f16e6ea9497e294265c4a17df0394ba}{}\label{classARC_1_1chainpars_a3f16e6ea9497e294265c4a17df0394ba} 
\index{A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}!exp\+\_\+fix\+\_\+iter@{exp\+\_\+fix\+\_\+iter}}
\index{exp\+\_\+fix\+\_\+iter@{exp\+\_\+fix\+\_\+iter}!A\+R\+C\+::chainpars@{A\+R\+C\+::chainpars}}
\subsubsection{\texorpdfstring{exp\+\_\+fix\+\_\+iter}{exp\_fix\_iter}}
{\footnotesize\ttfamily bool A\+R\+C\+::chainpars\+::exp\+\_\+fix\+\_\+iter}



flag showing whether the times of iteration is fixed or not 



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
C\+:/\+Users/longw/\+Documents/\+Git\+Hub/\+A\+R\+C/include/\hyperlink{AR_8h}{A\+R.\+h}\end{DoxyCompactItemize}
